<?xml version="1.0" encoding="utf-8"?>
<project name="Backpack" basedir="."
         default="build.all"
>
    <dirname property="backpack.basedir" file="${ant.file.Backpack}" />
<!--
    property definitions
-->
    <property name="backpack.src.dir" value="${backpack.basedir}/../src" />
    <property name="backpack.output.dir" value="${backpack.basedir}/../build" />

<!--
    default target
-->
    <target name="backpack.core.build"
            description="Builds Backpack"
    >
            <echo message="Building Backpack" />
            <concat destfile="${backpack.output.dir}/backpack.js">
                <filelist dir="${backpack.src.dir}">
                    <file name="backpack.core.js" />
                    <file name="backpack.slideBar.js" />
                    <file name="backpack.statusBar.js" />

                    <!-- run must always be last because backpack doesn't provide an onReady outside statusBar and slideBar -->
                    <file name="backpack.run.js" />
                </filelist>
            </concat>
    </target>

    <target name="build.all"
            description="Builds Backpack."
            depends="backpack.core.build"
    />

    <target name="test"
            description="Test build"
    >
        <echo message="Running tests" />
        <java jar="${backpack.test.rhino}"
            fork="true"
        >
            <arg value="${backpack.test.runner}" />
        </java>
        <echo message="Testing complete" />
    </target>
</project>
